<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf8"/>
    <meta name="viewport" content="initial-scale=1.0, width=device-width"/>
    <title>
      
        All File Systems Are Not Created Equal: On the Complexity of Crafting Crash-Consistent Applications 阅读 | ZPF.SITE
      
    </title>
    <meta name="description" content=""/>
    <meta name="keywords" content=""/>
    
      <link rel="apple-touch-icon"
            sizes="180x180"
            href="/images/apple-touch-icon.png"/>
    
    
      <link rel="icon"
            type="image/png"
            sizes="32x32"
            href="/images/favicon-32x32.png"/>
    
    
      <link rel="icon"
            type="image/png"
            sizes="16x16"
            href="/images/favicon-16x16.png"/>
    
    
      <link rel="mask-icon"
            href="/images/logo.svg"
            color=""/>
    
    
    
      
  <style>
    @font-face {
        font-family:sourceHanSerif;
        src: url(/font/regular.ttf);
        font-weight: regular;
    }
  </style>

  <style>
    @font-face {
        font-family:sourceHanSerif;
        src: url(/font/bold.ttf);
        font-weight: bold;
    }
  </style>


    
    <link rel="stylesheet"
          type="text/css"
          href='/css/layout.css'/>
    
    
  <link rel="stylesheet" type="text/css" href="/css/post.css" />
  

  <meta name="generator" content="Hexo 6.3.0"></head>
  <body>
    <div class="head">
      <div class="nav">
        <a href='/' class="nav-logo">
          <img alt="logo" height="60px" width="60px" src="/images/logo.svg"/>
        </a>
        <input id="navBtn" type="checkbox"/>
        <div class="nav-menu">
          
            
              <a class="nav-menu-item" href="/CS&Maths">Computer Science & Maths</a>
            
              <a class="nav-menu-item" href="/Life">Life</a>
            
          
          
        </div>
        <label class="nav-btn" for="navBtn"></label>
      </div>
    </div>
    <div class="body">
      
  <article class="post-content">
    <div class="post-inner--toc">
      <div class="post-content__head">
        <div class="post-title">All File Systems Are Not Created Equal: On the Complexity of Crafting Crash-Consistent Applications 阅读</div>
        <div class="post-info">
          
  <a href="/tags/Linux/" class="post-tag">#Linux</a><a href="/tags/File-System/" class="post-tag">#File System</a><a href="/tags/Dynamic-Analysis/" class="post-tag">#Dynamic Analysis</a><a href="/tags/OSDI/" class="post-tag">#OSDI</a><a href="/tags/OSDI-14/" class="post-tag">#OSDI'14</a><a href="/tags/Paper/" class="post-tag">#Paper</a>


          <span class="post-date">2023-09-06</span>
        </div>
      </div>
      
        <aside class="toc-outer">
          <div class="toc-title">目录</div>
          <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#bob"><span class="post-toc-text">BOB</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#alice"><span class="post-toc-text">ALICE</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#finding-application-requirements"><span class="post-toc-text">Finding Application Requirements</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E6%B5%8B%E8%AF%95%E8%B7%A8%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%E7%9A%84%E5%8E%9F%E5%AD%90%E6%80%A7"><span class="post-toc-text">测试跨系统调用的原子性</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E6%B5%8B%E8%AF%95%E5%8D%95%E4%B8%AA%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%E7%9A%84%E5%8E%9F%E5%AD%90%E6%80%A7"><span class="post-toc-text">测试单个系统调用的原子性</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E6%B5%8B%E8%AF%95%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%E9%97%B4%E7%9A%84%E9%A1%BA%E5%BA%8F%E4%BE%9D%E8%B5%96%E6%80%A7"><span class="post-toc-text">测试系统调用间的顺序依赖性</span></a></li></ol></li></ol></li></ol>
          <a href="#" class="toc-top">回到顶部</a>
        </aside>
      
      <div class="post-content__body">
        
          <div class="post-gallery">
            
          </div>
        
        <p>本文介绍了基于现代文件系统的应用层崩溃一致性协议的首个全面研究。研究发现，应用程序使用复杂的更新协议来持久化状态，而这些协议的正确性高度依赖于底层文件系统的微妙行为，我们称之为持久性属性。作者开发了一个名为BOB的工具来测试持久性属性，并使用它来证明这些属性在六种流行的Linux文件系统中存在广泛的差异。作者还构建了一个名为ALICE的框架，分析应用程序更新协议并发现崩溃漏洞，即需要特定持久性属性才能保证正确性的更新协议代码。使用ALICE，作者分析了11个广泛使用的系统，并发现了60个漏洞，其中许多会导致严重后果。作者还展示了ALICE可以用于评估新文件系统设计对应用程序级一致性的影响。 <span id="more"></span></p>
<p>研究发现，应用程序的一致性高度依赖于底层文件系统的持久性属性。如果应用程序的正确性依赖于特定的文件系统持久性属性，就会存在崩溃漏洞；在不同的文件系统上运行应用程序可能导致不正确的行为。</p>
<figure>
<img src="/All%20File%20Systems%20Are%20Not%20Created%20Equal:%20On%20the%20Complexity%20of%20Crafting%20Crash-Consistent%20Applications%20阅读/image1.png" alt="" /><figcaption>Crash States</figcaption>
</figure>
<h2 id="bob">BOB</h2>
<p>BOB是一个简单的工具，用于收集文件系统下的块级追踪，并重新排序以探索可能出现的磁盘崩溃状态，用于测试文件系统的持久性属性。它通过运行一个简单的工作负载来测试持久性属性，收集块I/O并重新排序，生成可能的磁盘状态。然后运行文件系统恢复并检查持久性属性是否成立。如果BOB找到一个检查失败的磁盘映像，则知道该属性在文件系统上不成立。</p>
<figure>
<img src="/All%20File%20Systems%20Are%20Not%20Created%20Equal:%20On%20the%20Complexity%20of%20Crafting%20Crash-Consistent%20Applications%20阅读/image3.png" alt="" /><figcaption>Persistence Properties</figcaption>
</figure>
<h2 id="alice">ALICE</h2>
<p>本文研究现代应用程序的崩溃一致性协议实现是否正确。为了回答这个问题，研究者们开发了一个名为ALICE的框架，可以系统地研究应用程序级别的崩溃一致性。</p>
<p>ALICE将应用工作负载中的系统调用跟踪转换为逻辑操作。逻辑操作将当前读写偏移量、文件描述符等细节抽象化，并将一组大量的系统调用和其他产生I/O行为转换为一小组文件系统操作。逻辑操作还将每个涉及的文件或目录关联到一个概念上的inode。</p>
<p>APM（Abstract Persistence Models）规定了文件系统中逻辑操作的原子性和顺序的所有限制，从而定义了可能的崩溃状态。</p>
<p>APM将崩溃状态表示为两个逻辑实体：包含数据和文件大小的file inode + 包含目录项的directory。</p>
<p>APM将逻辑操作分解为微操作，以捕捉中间崩溃状态。微操作是对每个逻辑实体执行的最小原子修改。共有五个微操作：write_block, change_file_size, create_dir_entry, delete_dir_entry。APM通过定义将逻辑操作转化为微操作来指定原子性约束。APM通过定义哪些微操作可以在其他微操作之前到达磁盘来指定排序约束。</p>
<figure>
<img src="/All%20File%20Systems%20Are%20Not%20Created%20Equal:%20On%20the%20Complexity%20of%20Crafting%20Crash-Consistent%20Applications%20阅读/image2.png" alt="" /><figcaption>Default APM Constraints</figcaption>
</figure>
<p>ALICE将系统调用跟踪转换为微操作，并计算它们之间的顺序依赖关系。ALICE通过将所选集合中的微操作顺序应用于初始状态（表示为逻辑实体），构造新的崩溃状态。对于每个崩溃状态，ALICE将逻辑实体转换回实际文件，并将其提供给检查器进行验证。用户提供的检查器验证崩溃状态。</p>
<figure>
<img src="/All%20File%20Systems%20Are%20Not%20Created%20Equal:%20On%20the%20Complexity%20of%20Crafting%20Crash-Consistent%20Applications%20阅读/image4.png" alt="" /><figcaption>Overview of ALICE</figcaption>
</figure>
<h3 id="finding-application-requirements">Finding Application Requirements</h3>
<h4 id="测试跨系统调用的原子性">测试跨系统调用的原子性</h4>
<p>它通过构建每个前缀（即前X个系统调用，1&lt;X&lt;N）应用的崩溃状态来实现。如果在这些崩溃状态中发现应用程序不变量被违反，则表示开始了一个原子组。(apply prefix of operations)</p>
<h4 id="测试单个系统调用的原子性">测试单个系统调用的原子性</h4>
<p>通过将所有先前的系统调用应用于崩溃状态，并生成对应于系统调用不同中间状态的崩溃状态，检查是否违反应用程序不变量。 (apply prefix + partial operation)</p>
<h4 id="测试系统调用间的顺序依赖性">测试系统调用间的顺序依赖性</h4>
<p>协议要求系统调用A必须在B之前进行持久化时，可以使用ALICE来测试这个属性。</p>
<p>ALICE从开始应用每个系统调用，直到达到B，但不包括A。这样可以检查A是否必须在B之前持久化。 如果B已应用但A没有，并且在这种情况下应用程序不变性被违反，表示存在A必须在B之前进行持久化的顺序依赖性。</p>

      </div>
    </div>
  </article>
  <div class="post__foot">
    
    <div class="post-nav">
  
    <a class="post-nav-item-left" href="/2023/09/07/SibylFS:%20formal%20specification%20and%20oracle-based%20testing%20for%20POSIX%20and%20real-world%20file%20systems%20%E9%98%85%E8%AF%BB/">
      <div class="text-align">
        <svg t="1670570876164"
             class="icon"
             viewBox="0 0 1024 1024"
             width="16"
             height="16">
          <path d="M384 512L731.733333 202.666667c17.066667-14.933333 19.2-42.666667 4.266667-59.733334-14.933333-17.066667-42.666667-19.2-59.733333-4.266666l-384 341.333333c-10.666667 8.533333-14.933333 19.2-14.933334 32s4.266667 23.466667 14.933334 32l384 341.333333c8.533333 6.4 19.2 10.666667 27.733333 10.666667 12.8 0 23.466667-4.266667 32-14.933333 14.933333-17.066667 14.933333-44.8-4.266667-59.733334L384 512z" p-id="14596"/>
        </svg>
        <span class="text-small">上一篇</span>
      </div>
      <div>SibylFS: formal specification and oracle-based testing for POSIX and real-world file systems 阅读</div>
    </a>
  
  <div class="vhr"></div>
  
    <a class="post-nav-item-right" href="/2023/09/05/zsh%20&%20oh-my-zsh/">
      <div class="text-align">
        <span class="text-small">下一篇</span>
        <svg t="1670570876164"
             class="icon"
             viewBox="0 0 1024 1024"
             transform="scale(-1,-1)"
             width="16"
             height="16">
          <path d="M384 512L731.733333 202.666667c17.066667-14.933333 19.2-42.666667 4.266667-59.733334-14.933333-17.066667-42.666667-19.2-59.733333-4.266666l-384 341.333333c-10.666667 8.533333-14.933333 19.2-14.933334 32s4.266667 23.466667 14.933334 32l384 341.333333c8.533333 6.4 19.2 10.666667 27.733333 10.666667 12.8 0 23.466667-4.266667 32-14.933333 14.933333-17.066667 14.933333-44.8-4.266667-59.733334L384 512z" p-id="14596"/>
        </svg>
      </div>
      zsh & oh-my-zsh 常用命令
    </a>
  
</div>

    
      <div class="related-post">
  <div class="related__head">
  <a href="/tags/Linux/" class="post-tag">#Linux</a><a href="/tags/File-System/" class="post-tag">#File System</a><a href="/tags/Dynamic-Analysis/" class="post-tag">#Dynamic Analysis</a><a href="/tags/OSDI/" class="post-tag">#OSDI</a><a href="/tags/OSDI-14/" class="post-tag">#OSDI'14</a><a href="/tags/Paper/" class="post-tag">#Paper</a>

</div>
  <div class="realated__body">
    
      <div class="null"><div class="null-item"><div class="null-title"><a href="/2023/08/31/Cross-checking Semantic Correctness: The Case of Finding File System Bugs 阅读/" title="Cross-checking Semantic Correctness: The Case of Finding File System Bugs 阅读" rel="bookmark">Cross-checking Semantic Correctness: The Case of Finding File System Bugs 阅读</a></div></div><div class="null-item"><div class="null-title"><a href="/2023/09/07/SibylFS: formal specification and oracle-based testing for POSIX and real-world file systems 阅读/" title="SibylFS: formal specification and oracle-based testing for POSIX and real-world file systems 阅读" rel="bookmark">SibylFS: formal specification and oracle-based testing for POSIX and real-world file systems 阅读</a></div></div><div class="null-item"><div class="null-title"><a href="/2023/09/26/Creating Pipes in C/" title="Creating Pipes in C" rel="bookmark">Creating Pipes in C</a></div></div><div class="null-item"><div class="null-title"><a href="/2023/11/07/@蓝色老师的LLVM系列文章汇总/" title="@蓝色老师的LLVM系列文章汇总" rel="bookmark">@蓝色老师的LLVM系列文章汇总</a></div></div><div class="null-item"><div class="null-title"><a href="/2023/10/30/All You Ever Wanted to Know About Dynamic Taint Analysis and Forward Symbolic Execution 阅读/" title="All You Ever Wanted to Know About Dynamic Taint Analysis and Forward Symbolic Execution 阅读" rel="bookmark">All You Ever Wanted to Know About Dynamic Taint Analysis and Forward Symbolic Execution 阅读</a></div></div></div>
    
  </div>
</div>

    
    
    
      <script src="https://utteranc.es/client.js"
    repo="jtzhpf/jtzhpf.github.io"
    issue-term="pathname"
    theme="github-light"
    crossorigin="anonymous"
    async>
</script>
    
  </div>

    </div>
    <div class="foot">
      <div class="foot-inner">
        <div class="foot__head">
          
            <div class="foot-line">
              
                <div class="matts">海</div>
              
                <div class="matts">内</div>
              
                <div class="matts">存</div>
              
                <div class="matts">知</div>
              
                <div class="matts">己</div>
              
            </div>
          
            <div class="foot-line">
              
                <div class="matts">天</div>
              
                <div class="matts">涯</div>
              
                <div class="matts">若</div>
              
                <div class="matts">比</div>
              
                <div class="matts">邻</div>
              
            </div>
          
        </div>
        <div class="foot__body">
          
          
            <div class="foot-item">
              <div class="foot-item__head">账号</div>
              <div class="foot-item__body">
                
                  <div class="text">
                    <img alt="link" height="20px" width="20px" src="/images/logo-github.svg"/>
                    <a class="foot-link" target="_blank" rel="noopener" href="https://github.com/jtzhpf">github</a>
                  </div>
                
              </div>
            </div>
          
          <div class="foot-item">
            <div class="foot-item__head">联系</div>
            <div class="foot-item__body">
              <div class="text">
                <img alt="link" height="20px" width="20px" src="/images/icon/icon-email.svg"/>
                <a class="foot-link" href="mailto:jtzhpf@126.com">jtzhpf@126.com</a>
              </div>
            </div>
          </div>
        </div>
        <div class="copyright">
          <a href="https://zpf.pages.dev">ZPF.SITE</a> &nbsp;|&nbsp;由&nbsp;<a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>&nbsp;及&nbsp;
          <svg width="20" height="20" viewBox="0 0 725 725">
            <path fill-rule="evenodd" fill="rgb(221, 221, 221)" d="M145.870,236.632 L396.955,103.578 L431.292,419.44 L156.600,522.53 L145.870,236.632 Z"/>
            <path fill-rule="evenodd" fill="rgb(159, 159, 159)" d="M396.955,103.578 L564.345,234.486 L611.558,513.469 L431.292,419.44 L396.955,103.578 Z"/>
            <path fill-rule="evenodd" fill="rgb(0, 0, 0)" d="M431.292,419.44 L611.558,513.469 L358.327,595.18 L156.600,522.53 L431.292,419.44 Z"/>
          </svg>
          <a target="_blank" rel="noopener" href="https://github.com/hooozen/hexo-theme-tranquility">致远</a>&nbsp;驱动
        </div>
      </div>
    </div>
    
    
    <script src="https://cdn.bootcdn.net/ajax/libs/mermaid/10.4.0/mermaid.min.js"></script>
    
    
  

  </body>
</html>